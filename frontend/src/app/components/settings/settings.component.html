<section *ngIf="currentUser" class="tfa-form" fxLayout="column" fxLayoutAlign="center center" >
  <div *ngIf="!currentUser.tfaEnabled">
      <mat-card *ngIf='tfaSetup'>
          <mat-card-title fxLayoutAlign="center center">Setup TFA</mat-card-title>
          <mat-card-subtitle>Scan the QR code or enter the secret key in Google Authenticator</mat-card-subtitle>
          <img mat-card-image src="{{tfaSetup.dataURL}}">
          <p>Secret: {{tfaSetup.tempSecret}}</p>
          <p>Auth Type - Time Based - OTP</p>
          <form fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="5px" [formGroup]="tfaEnableForm" (ngSubmit)="onSubmit()">
              <mat-form-field>
                <input type="text" matInput placeholder="Auth code" formControlName="authcode" >
                <mat-error *ngIf="tfaEnableForm.controls['authcode'].hasError('required')">Auth code field is required</mat-error>
              </mat-form-field>
              <button type="submit" mat-raised-button [disabled]="tfaEnableForm.invalid" color="primary">Submit</button>
          </form>
      </mat-card>
  </div>
  <div *ngIf="currentTFASettings">
    <mat-card>
        <mat-card-title fxLayoutAlign="center center">Current TFA settings</mat-card-title>
        <p>Secret: {{currentTFASettings}}</p>
        <p>Auth Type - Time Based - OTP</p>
        <button mat-raised-button color="primary" (click)="disableTFA()">Disable TFA</button>
    </mat-card>
  </div>

  </section>